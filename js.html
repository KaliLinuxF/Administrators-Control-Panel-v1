<script>
	let textInput = document.getElementById('txtInput');
	let table = document.getElementById('adminInfoTable'); // Таблица отображения
	let info = table.rows[1].cells; // Ячейки второго ряда
	let alertMsg = document.getElementById('hasAdminAlert');
	let buttonsDiv = document.getElementById('buttons');

	function callServerFindAdmin() {
	  google.script.run.withSuccessHandler(successFindAdmin).getAdminsInfo();
	}

	function successFindAdmin(admins) {
	  
	  let hasAdmin = false;
	  let admin = textInput.value;
	  let index = 0;

	  for(let i = 0; i < admins.length; i++) {
		for(let j = 0; j < admins[i].length; j++) {
		  if(admins[i][j] == admin) {
			index = i;
			hasAdmin = true;
		  }
		}
	  }

	  if(!hasAdmin) {
		buttonsDiv.style.display = "none";
		table.style.display = "none";

		alertMsg.innerHTML = "[❌] Администратор " + admin + " не найден.";
		alertMsg.style.color = "crimson";
		alertMsg.style.display = "block";

		return;
	  }

		alertMsg.innerHTML = `[✔️] Администратор ${admin} найден.`;
		alertMsg.style.color = "green";
		alertMsg.style.display = "block";

		info[0].innerHTML = admins[index][0];
		info[1].innerHTML = admins[index][1];
		info[2].innerHTML = admins[index][2];
		info[3].innerHTML = admins[index][3];
		info[4].innerHTML = admins[index][4];
		info[5].innerHTML = admins[index][5];

		table.style.display = "inline";
		buttonsDiv.style.display = "inline";
	}

	function callServerRemoveAdmin() {
	  google.script.run.withSuccessHandler(onSuccessRemoveAdmin).removeAdmin(textInput.value);
	}

	function onSuccessRemoveAdmin(admin) {

	  table.style.display = "none";
	  buttonsDiv.style.display = "none";
	  alertMsg.style.color = "orange";
	  alertMsg.innerHTML = `[⚠️] Администратор ${admin} был снят.`;

	}

	function callServerSetPred() {
	  google.script.run.withSuccessHandler(onSuccessSetPred).setPred(textInput.value);
	}

	function onSuccessSetPred(admin) {
	  alertMsg.style.color = "orange";
	  alertMsg.innerHTML = `[⚠️] Администратору ${admin} выдано предупреждение.`;

	  callServerUpdateTable(admin);
	}
	
	function callServerSetWarn() {
	  google.script.run.withSuccessHandler(onSuccessSetWarn).setWarn(textInput.value);
	}

	function onSuccessSetWarn(admin) {
	  alertMsg.style.color = "crimson";
	  alertMsg.innerHTML = `[❌] Администратору ${admin} выдан выговор.`;

	  callServerUpdateTable(admin);
	}

	function callServerUpdateTable() {
	  google.script.run.withSuccessHandler(onSuccessUpdateTable).getAdminsInfo(textInput.value);
	}

	function onSuccessUpdateTable(admins) {

	  let admin = textInput.value;
	  let index = 0;

	  for(let i = 0; i < admins.length; i++) {
		for(let j = 0; j < admins[i].length; j++) {
		  if(admins[i][j] == admin) {
			index = i;
		  }
		}
	  }

		info[0].innerHTML = admins[index][0];
		info[1].innerHTML = admins[index][1];
		info[2].innerHTML = admins[index][2];
		info[3].innerHTML = admins[index][3];
		info[4].innerHTML = admins[index][4];
		info[5].innerHTML = admins[index][5];

	}

  </script>